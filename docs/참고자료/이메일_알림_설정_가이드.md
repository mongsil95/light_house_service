# 이메일 알림 기능 설정 가이드

## 1. Resend 계정 생성 및 API 키 발급

1. [Resend](https://resend.com)에 가입합니다
2. 도메인을 추가하거나, 테스트용으로 제공되는 `onboarding@resend.dev` 사용 가능
3. API Keys 메뉴에서 새 API 키를 생성합니다

## 2. 환경변수 설정

`.env.local` 파일에 다음 변수들을 추가하세요:

```bash
# Resend API Key
RESEND_API_KEY=re_xxxxxxxxxxxxxxxxxxxxxxxxxx

# 사이트 URL (이메일 링크에 사용)
NEXT_PUBLIC_SITE_URL=http://localhost:3000  # 개발 환경
# NEXT_PUBLIC_SITE_URL=https://yourdomain.com  # 프로덕션 환경
```

## 3. 도메인 설정 (프로덕션용)

### 3.1 Resend에서 도메인 인증

1. Resend 대시보드에서 "Domains" 메뉴 선택
2. "Add Domain" 클릭
3. 도메인 입력 (예: `yourdomain.com`)
4. DNS 레코드 추가:
   - MX 레코드
   - TXT 레코드 (SPF, DKIM)
5. 인증 완료될 때까지 대기 (보통 몇 분 ~ 24시간)

### 3.2 이메일 발신자 주소 변경

`/lib/email.ts` 파일에서 `from` 필드를 실제 도메인으로 변경:

```typescript
from: "등대지기 반려해변 <noreply@yourdomain.com>";
```

## 4. 테스트

### 4.1 질문 등록 테스트

1. `/adopt-a-beach/expertsqna/ask`에서 질문 작성
2. 이메일 주소 입력
3. 제출 후 `happything@itaseoul.org`로 알림 메일 확인

### 4.2 답변 등록 테스트

1. 관리자 페이지 `/admin/qna`에서 질문 선택
2. 답변 작성 및 제출
3. 질문자 이메일로 답변 알림 메일 확인

## 5. 주의사항

### 개발 환경 (Resend 무료 플랜)

- 일일 이메일 전송 제한: 100개
- 인증된 도메인 없이 테스트 가능
- `onboarding@resend.dev`에서 발송되는 메일은 등록된 수신자에게만 전송

### 프로덕션 환경

- 반드시 실제 도메인 인증 필요
- 이메일 발송량에 따라 플랜 업그레이드 고려
- SPF, DKIM, DMARC 레코드 올바르게 설정

## 6. 문제 해결

### 이메일이 전송되지 않는 경우

1. `.env.local`의 `RESEND_API_KEY` 확인
2. Resend 대시보드에서 API 키가 활성화되어 있는지 확인
3. 서버 재시작 (환경변수 변경 후)
4. Resend 대시보드의 "Logs" 메뉴에서 전송 로그 확인

### 이메일이 스팸함으로 가는 경우

1. 도메인 DNS 레코드 확인 (SPF, DKIM, DMARC)
2. 발신자 주소를 실제 도메인으로 변경
3. 이메일 내용에 스팸 키워드 없는지 확인

## 7. 대안 서비스

Resend 외에 다른 이메일 서비스를 사용하려면:

### SendGrid

```bash
npm install @sendgrid/mail
```

### Nodemailer (SMTP)

```bash
npm install nodemailer
```

각 서비스마다 설정 방법이 다르므로 공식 문서를 참고하세요.
